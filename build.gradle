plugins {
    id 'java'
    id 'findbugs'
    id 'pmd'
    id 'jacoco'
    id 'build-announcements'
    id "nebula.optional-base" version "3.0.3"
    id "nebula.provided-base" version "3.0.3"
    id "nebula.info" version "3.0.3"
    id "nebula.nebula-javadoc-jar" version "2.2.2"
    id "nebula.nebula-source-jar" version "2.2.2"
    id "com.github.ben-manes.versions" version "0.12.0"
    id "ru.vyarus.github-info" version "1.0.0"
    id 'nebula.nebula-bintray' version '3.3.4'
    id 'maven-publish'

}

description="This project aims to provide the facility to easily implement JSON-RPC for the java programming language. jsonrpc4j uses the Jackson library to convert java objects to and from json objects (and other things related to JSON-RPC)."
version="1.2.1"

sourceCompatibility = 1.7
targetCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    ext {
        jacksonVersion = '2.6.5'
        springVersion = '4.2.4.RELEASE'
        springBotVersion = '1.3.2.RELEASE'
        jettyVersion = '9.3.7.v20160115'
    }

    compile 'net.iharder:base64:2.3.9'
    compile 'org.apache.logging.log4j:log4j-core:2.5'
    provided 'javax.portlet:portlet-api:2.0'
    provided 'javax.servlet:javax.servlet-api:3.1.0'


    compile "com.fasterxml.jackson.core:jackson-core:${jacksonVersion}"
    compile "com.fasterxml.jackson.core:jackson-databind:${jacksonVersion}"
    compile "com.fasterxml.jackson.core:jackson-annotations:${jacksonVersion}"

    compile "org.springframework:spring-core:${springVersion}", optional
    compile "org.springframework:spring-context:${springVersion}", optional
    compile "org.springframework:spring-web:${springVersion}", optional
    compile "org.springframework:spring-webmvc:${springVersion}", optional


    compile 'commons-codec:commons-codec:1.10', optional
    compile 'org.apache.httpcomponents:httpcore-nio:4.4.4', optional

    testCompile 'junit:junit:4.12'
    testCompile 'org.easymock:easymock:3.4'
    testCompile "org.springframework.boot:spring-boot-starter-web:${springBotVersion}"
    testCompile("org.springframework.boot:spring-boot-starter-test:${springBotVersion}")
    testCompile("org.eclipse.jetty:jetty-server:${jettyVersion}") {
        exclude module: 'javax.servlet'
    }
    testCompile("org.eclipse.jetty:jetty-servlet:${jettyVersion}") {
        exclude module: 'org.eclipse.jetty.orbit'
    }
}

jacoco {
    toolVersion = '0.7.6.201602180812'
    reportsDir = file("$buildDir/customJacocoReportDir")
}

jacocoTestReport {
    reports {
        xml.enabled false
        csv.enabled false
        html.destination "${buildDir}/jacocoHtml"
    }
}

github {
    user 'gaborbernat'
    license 'MIT'
}


bintray {
    dryRun = false
    publish = true
    pkg {
        repo = 'gradle-plugins'
        userOrg = 'nebula'
        name = 'project.name'
        desc = project.description
        websiteUrl = 'https://briandilley.github.io/jsonrpc4j'
        issueTrackerUrl = 'https://github.com/briandilley/jsonrpc4j/issues'
        vcsUrl = 'git@github.com:briandilley/jsonrpc4j.git'
        licenses = ['MIT']
        labels = ['json', 'rpc', 'java']
        publicDownloadNumbers = true
        attributes = [:]
        version {
            name = project.version
            vcsTag = project.version
            attributes = [:]
        }
    }
}
